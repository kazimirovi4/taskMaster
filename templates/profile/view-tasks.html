{% load static %}

{% load crispy_forms_tags %}

<html>

    <head>

        <meta charset="UTF-8" />
        <meta name="viewport" content="width-device-width, initial-scale=1, maximum-scale=1"/>

        <link rel="stylesheet" type="text/css" href="https://bootswatch.com/5/solar/bootstrap.min.css">
        <link rel="stylesheet" type="text/css" href="{% static 'css/styles.css' %}">

        <title>Посмотреть задачу</title>

    </head>

    {% include 'base.html' %}

    <br>

    <body>
        <div class="container mt-4">

            <h3>Задачи</h3>

            <form method="get" class="mb-4 p-3 border rounded shadow-sm bg-light">

                <h4>Фильтр задач</h4>

                {{ form|crispy }}

                <br>

                <button type="submit" class="btn btn-primary mt-2">Применить фильтр</button>

                <a href="{% url 'view-task' %}" class="btn btn-secondary mt-2">Сбросить фильтр</a>

            </form>

        <br>

            {% for tsk in task %}

            <div class="container bg-white shadow-md p-4 mb-4 rounded">

                <h5>{{ tsk.title }}</h5>

                <p>{{ tsk.content }}</p>

                <p><strong>Дата создания:</strong> {{ tsk.date_posted }}</p>

                <p><strong>Срок выполнения:</strong> {{ tsk.due_date|date:"d.m.Y" }}</p>

                <p><strong>Приоритет:</strong> {{ tsk.get_priority_display }}</p>

                <p><strong>Статус:</strong> {{ tsk.get_status_display }}</p>

                <p><strong>Ответственный:</strong>

                    {% if tsk.responsible %}

                        {{ tsk.responsible.username }}

                    {% else %}

                        Не назначен

                    {% endif %}

                </p>

                <p><strong>Проект:</strong>

                    {% if tsk.project %}

                        {{ tsk.project.name }}

                    {% else %}

                        Не привязан к проекту

                    {% endif %}

                </p>

                <div class="mt-3">

                    <a class="btn btn-info" href="{% url 'update-task' tsk.id %}">Обновить задачу</a>

                    <a class="btn btn-danger" href="{% url 'delete-task' tsk.id %}">Удалить задачу</a>

                    <a class="btn btn-secondary" href="{% url 'task-detail' tsk.id %}">Комментарии</a>

                </div>

            </div>

            {% empty %}

            <p>Задачи не найдены.</p>

            {% endfor %}

        </div>

    </body>

</html>